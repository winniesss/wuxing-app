# 微信登录配置指南

## 一、注册微信开放平台账号

1. **访问微信开放平台**
   - 网址：https://open.weixin.qq.com/
   - 点击右上角"注册"按钮

2. **填写注册信息**
   - 邮箱地址（用于接收验证码）
   - 设置密码
   - 验证邮箱
   - 填写企业/个人资料

3. **账号认证**
   - 个人开发者：需要身份证认证
   - 企业开发者：需要企业资质认证（营业执照等）
   - 认证需要1-3个工作日

## 二、创建网站应用

1. **登录微信开放平台**
   - 使用注册的账号登录

2. **创建网站应用**
   - 进入"管理中心" → "网站应用"
   - 点击"创建网站应用"
   - 填写应用信息：
     - 应用名称：五行天干地支背诵（或你的应用名称）
     - 应用简介：描述你的应用
     - 应用官网：你的网站地址（如：https://yourdomain.com）
     - 应用回调域名：你的域名（如：yourdomain.com）

3. **提交审核**
   - 填写完信息后提交审核
   - 审核通常需要1-7个工作日

## 三、获取 AppID 和 AppSecret

1. **审核通过后**
   - 在"网站应用"列表中找到你的应用
   - 点击应用名称进入详情页

2. **查看 AppID**
   - AppID（应用ID）：在应用详情页可以看到
   - 格式类似：`wx1234567890abcdef`

3. **获取 AppSecret**
   - 点击"查看"按钮查看 AppSecret
   - 首次查看需要验证身份
   - **重要**：AppSecret 只显示一次，请妥善保存

## 四、配置到项目中

### 方法一：使用环境变量（推荐）

1. **创建 `.env` 文件**
   ```bash
   cd wuxing-app
   touch .env
   ```

2. **在 `.env` 文件中添加**
   ```env
   VITE_WECHAT_APPID=你的AppID
   VITE_WECHAT_APPSECRET=你的AppSecret（如果需要后端验证）
   ```

3. **注意**：
   - `.env` 文件不要提交到 Git（已在 .gitignore 中）
   - 重启开发服务器使环境变量生效

### 方法二：直接修改代码（不推荐，仅用于测试）

在 `src/Login.jsx` 中直接修改：
```javascript
const WECHAT_APPID = '你的AppID';
```

## 五、配置回调地址

1. **在微信开放平台设置**
   - 应用详情页 → "开发信息"
   - 设置"授权回调域名"
   - 格式：`yourdomain.com`（不需要 http:// 或 https://）

2. **后端处理回调**
   - 需要创建一个后端接口处理微信回调
   - 回调地址示例：`https://yourdomain.com/auth/wechat`
   - 后端需要：
     1. 接收微信返回的 `code`
     2. 使用 `code` 和 `AppSecret` 换取 `access_token`
     3. 使用 `access_token` 获取用户信息
     4. 返回用户信息给前端

## 六、测试微信登录

### 开发环境测试

1. **使用模拟登录**（当前实现）
   - 不配置 AppID 时，点击微信登录会创建模拟用户
   - 适合开发测试

2. **使用真实微信登录**
   - 配置 AppID 后
   - 需要配置 HTTPS（微信要求）
   - 需要后端支持处理回调

### 生产环境部署

1. **必须使用 HTTPS**
   - 微信登录要求网站必须使用 HTTPS
   - 可以使用 Let's Encrypt 免费证书

2. **配置后端服务器**
   - 处理微信授权回调
   - 安全存储 AppSecret（不要暴露在前端）

## 七、常见问题

### Q1: 个人开发者可以申请吗？
A: 可以，但需要身份证认证，且功能可能有限制。

### Q2: 审核需要多长时间？
A: 通常1-7个工作日，具体时间取决于审核情况。

### Q3: AppSecret 泄露了怎么办？
A: 立即在微信开放平台重置 AppSecret，旧密钥会立即失效。

### Q4: 本地开发如何测试？
A: 可以使用模拟登录，或者使用内网穿透工具（如 ngrok）将本地服务映射到公网。

### Q5: 必须要有后端吗？
A: 是的，微信登录需要后端服务器处理授权回调，因为 AppSecret 不能暴露在前端。

## 八、简化方案（仅前端演示）

如果只是用于演示，可以：

1. **使用模拟登录**（当前已实现）
   - 不配置 AppID
   - 点击微信登录直接创建模拟用户

2. **使用第三方服务**
   - 使用 Auth0、Firebase Auth 等第三方认证服务
   - 这些服务通常已经集成了微信登录

## 九、相关链接

- 微信开放平台：https://open.weixin.qq.com/
- 微信登录文档：https://developers.weixin.qq.com/doc/oplatform/Website_App/WeChat_Login/Wechat_Login.html
- 微信开放平台帮助中心：https://open.weixin.qq.com/cgi-bin/frame?t=help/index_tmpl

---

**注意**：微信登录需要后端服务器支持，纯前端无法完成完整的微信登录流程。当前实现中的模拟登录仅用于开发测试。

